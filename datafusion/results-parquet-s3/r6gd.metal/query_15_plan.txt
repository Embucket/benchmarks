DataFusion EXPLAIN ANALYZE - Query 15
================================================================================

DataFusion CLI v50.2.0
0 row(s) fetched. 
Elapsed 0.001 seconds.

0 row(s) fetched. 
Elapsed 0.383 seconds.

0 row(s) fetched. 
Elapsed 5.265 seconds.

0 row(s) fetched. 
Elapsed 0.126 seconds.

0 row(s) fetched. 
Elapsed 1.208 seconds.

0 row(s) fetched. 
Elapsed 0.346 seconds.

0 row(s) fetched. 
Elapsed 0.770 seconds.

0 row(s) fetched. 
Elapsed 0.101 seconds.

0 row(s) fetched. 
Elapsed 0.184 seconds.

0 row(s) fetched. 
Elapsed 0.002 seconds.

+-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type         | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Plan with Metrics | SortPreservingMergeExec: [s_suppkey@0 ASC NULLS LAST], metrics=[output_rows=1, elapsed_compute=12.636µs]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                   |   SortExec: expr=[s_suppkey@0 ASC NULLS LAST], preserve_partitioning=[true], metrics=[output_rows=1, elapsed_compute=43.371µs, spill_count=0, spilled_bytes=0.0 B, spilled_rows=0, batches_split=0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                   |     CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=1, elapsed_compute=1.942637ms]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                   |       HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(max(revenue0.total_revenue)@0, total_revenue@4)], projection=[s_suppkey@1, s_name@2, s_address@3, s_phone@4, total_revenue@5], metrics=[output_rows=1, elapsed_compute=177.339237ms, build_input_batches=1, build_input_rows=1, input_batches=1247, input_rows=10000000, output_batches=1247, build_mem_used=89, build_time=3.15863ms, join_time=174.074297ms]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   |         AggregateExec: mode=Final, gby=[], aggr=[max(revenue0.total_revenue)], metrics=[output_rows=1, elapsed_compute=89.878µs]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                   |           CoalescePartitionsExec, metrics=[output_rows=32, elapsed_compute=28.184µs]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                   |             AggregateExec: mode=Partial, gby=[], aggr=[max(revenue0.total_revenue)], metrics=[output_rows=32, elapsed_compute=13.850213ms]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   |               ProjectionExec: expr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@1 as total_revenue], metrics=[output_rows=10000000, elapsed_compute=578.868µs]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                   |                 AggregateExec: mode=FinalPartitioned, gby=[l_suppkey@0 as l_suppkey], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)], metrics=[output_rows=10000000, elapsed_compute=34.258193425s, spill_count=0, spilled_bytes=0.0 B, spilled_rows=0, peak_mem_used=646014976]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                   |                   CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=229391767, elapsed_compute=3.735538938s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                   |                     RepartitionExec: partitioning=Hash([l_suppkey@0], 32), input_partitions=32, metrics=[fetch_time=2816.819052869s, repartition_time=5.549891583s, send_time=1.239896568s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                   |                       AggregateExec: mode=Partial, gby=[l_suppkey@0 as l_suppkey], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)], metrics=[output_rows=229391767, elapsed_compute=11.794660795s, spill_count=0, spilled_bytes=0.0 B, spilled_rows=0, skipped_aggregation_rows=226112459, peak_mem_used=165575552]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                   |                         CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=229410545, elapsed_compute=3.465044112s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                   |                           FilterExec: l_shipdate@3 >= 1996-08-01 AND l_shipdate@3 < 1996-11-01, projection=[l_suppkey@0, l_extendedprice@1, l_discount@2], metrics=[output_rows=229410545, elapsed_compute=18.717243471s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                   |                             DataSourceExec: file_groups={32 groups: [[tpch/1000/lineitem.parquet:0..8269527463], [tpch/1000/lineitem.parquet:8269527463..16539054926], [tpch/1000/lineitem.parquet:16539054926..24808582389], [tpch/1000/lineitem.parquet:24808582389..33078109852], [tpch/1000/lineitem.parquet:33078109852..41347637315], ...]}, projection=[l_suppkey, l_extendedprice, l_discount, l_shipdate], file_type=parquet, predicate=l_shipdate@3 >= 1996-08-01 AND l_shipdate@3 < 1996-11-01, pruning_predicate=l_shipdate_null_count@1 != row_count@2 AND l_shipdate_max@0 >= 1996-08-01 AND l_shipdate_null_count@1 != row_count@2 AND l_shipdate_min@3 < 1996-11-01, required_guarantees=[], metrics=[output_rows=5999989709, elapsed_compute=32ns, batches_split=0, bytes_scanned=91981441124, file_open_errors=0, file_scan_errors=0, files_ranges_pruned_statistics=0, num_predicate_creation_errors=0, page_index_rows_matched=5999989709, page_index_rows_pruned=0, predicate_evaluation_errors=0, pushdown_rows_matched=0, pushdown_rows_pruned=0, row_groups_matched_bloom_filter=0, row_groups_matched_statistics=32767, row_groups_pruned_bloom_filter=0, row_groups_pruned_statistics=0, bloom_filter_eval_time=301.130288ms, metadata_load_time=188.454786061s, page_index_eval_time=347.428407ms, row_pushdown_eval_time=64ns, statistics_eval_time=6.211193ms, time_elapsed_opening=189.149204864s, time_elapsed_processing=386.002051022s, time_elapsed_scanning_total=2634.717085815s, time_elapsed_scanning_until_data=14.37149025s] |
|                   |         CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=10000000, elapsed_compute=2.835666707s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                   |           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(s_suppkey@0, supplier_no@0)], projection=[s_suppkey@0, s_name@1, s_address@2, s_phone@3, total_revenue@5], metrics=[output_rows=10000000, elapsed_compute=8.835060075s, build_input_batches=1216, build_input_rows=10000000, input_batches=1247, input_rows=10000000, output_batches=1247, build_mem_used=1414616561, build_time=3.783268664s, join_time=2.134433419s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                   |             CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=10000000, elapsed_compute=2.831270695s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                   |               RepartitionExec: partitioning=Hash([s_suppkey@0], 32), input_partitions=32, metrics=[fetch_time=17.514648554s, repartition_time=430.157072ms, send_time=67.466677ms]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                   |                 DataSourceExec: file_groups={32 groups: [[tpch/1000/supplier.parquet:0..27849219], [tpch/1000/supplier.parquet:27849219..55698438], [tpch/1000/supplier.parquet:55698438..83547657], [tpch/1000/supplier.parquet:83547657..111396876], [tpch/1000/supplier.parquet:111396876..139246095], ...]}, projection=[s_suppkey, s_name, s_address, s_phone], file_type=parquet, metrics=[output_rows=10000000, elapsed_compute=32ns, batches_split=0, bytes_scanned=568609416, file_open_errors=0, file_scan_errors=0, files_ranges_pruned_statistics=0, num_predicate_creation_errors=0, page_index_rows_matched=0, page_index_rows_pruned=0, predicate_evaluation_errors=0, pushdown_rows_matched=0, pushdown_rows_pruned=0, row_groups_matched_bloom_filter=0, row_groups_matched_statistics=0, row_groups_pruned_bloom_filter=0, row_groups_pruned_statistics=0, bloom_filter_eval_time=64ns, metadata_load_time=94.838286ms, page_index_eval_time=64ns, row_pushdown_eval_time=64ns, statistics_eval_time=64ns, time_elapsed_opening=104.085829ms, time_elapsed_processing=1.974809171s, time_elapsed_scanning_total=17.94398154s, time_elapsed_scanning_until_data=4.597115202s]                                                                                                                                                                                                                                                                                                                                                                       |
|                   |             ProjectionExec: expr=[l_suppkey@0 as supplier_no, sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@1 as total_revenue], metrics=[output_rows=10000000, elapsed_compute=1.404803ms]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                   |               AggregateExec: mode=FinalPartitioned, gby=[l_suppkey@0 as l_suppkey], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)], metrics=[output_rows=10000000, elapsed_compute=34.473308465s, spill_count=0, spilled_bytes=0.0 B, spilled_rows=0, peak_mem_used=644532224]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                   |                 CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=229391767, elapsed_compute=3.864630201s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   |                   RepartitionExec: partitioning=Hash([l_suppkey@0], 32), input_partitions=32, metrics=[fetch_time=2637.648740728s, repartition_time=5.464217452s, send_time=1.246300453s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                   |                     AggregateExec: mode=Partial, gby=[l_suppkey@0 as l_suppkey], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)], metrics=[output_rows=229391767, elapsed_compute=11.761938083s, spill_count=0, spilled_bytes=0.0 B, spilled_rows=0, skipped_aggregation_rows=226112459, peak_mem_used=165575552]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                   |                       CoalesceBatchesExec: target_batch_size=8192, metrics=[output_rows=229410545, elapsed_compute=3.499178937s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                   |                         FilterExec: l_shipdate@3 >= 1996-08-01 AND l_shipdate@3 < 1996-11-01, projection=[l_suppkey@0, l_extendedprice@1, l_discount@2], metrics=[output_rows=229410545, elapsed_compute=18.852870322s]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                   |                           DataSourceExec: file_groups={32 groups: [[tpch/1000/lineitem.parquet:0..8269527463], [tpch/1000/lineitem.parquet:8269527463..16539054926], [tpch/1000/lineitem.parquet:16539054926..24808582389], [tpch/1000/lineitem.parquet:24808582389..33078109852], [tpch/1000/lineitem.parquet:33078109852..41347637315], ...]}, projection=[l_suppkey, l_extendedprice, l_discount, l_shipdate], file_type=parquet, predicate=l_shipdate@3 >= 1996-08-01 AND l_shipdate@3 < 1996-11-01, pruning_predicate=l_shipdate_null_count@1 != row_count@2 AND l_shipdate_max@0 >= 1996-08-01 AND l_shipdate_null_count@1 != row_count@2 AND l_shipdate_min@3 < 1996-11-01, required_guarantees=[], metrics=[output_rows=5999989709, elapsed_compute=32ns, batches_split=0, bytes_scanned=91981441124, file_open_errors=0, file_scan_errors=0, files_ranges_pruned_statistics=0, num_predicate_creation_errors=0, page_index_rows_matched=5999989709, page_index_rows_pruned=0, predicate_evaluation_errors=0, pushdown_rows_matched=0, pushdown_rows_pruned=0, row_groups_matched_bloom_filter=0, row_groups_matched_statistics=32767, row_groups_pruned_bloom_filter=0, row_groups_pruned_statistics=0, bloom_filter_eval_time=306.531486ms, metadata_load_time=191.375934692s, page_index_eval_time=353.446504ms, row_pushdown_eval_time=64ns, statistics_eval_time=5.730702ms, time_elapsed_opening=192.179206908s, time_elapsed_processing=387.1354257s, time_elapsed_scanning_total=2452.442705547s, time_elapsed_scanning_until_data=13.691296504s]    |
|                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+-------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row(s) fetched. 
Elapsed 182.599 seconds.

0 row(s) fetched. 
Elapsed 0.000 seconds.


================================================================================
