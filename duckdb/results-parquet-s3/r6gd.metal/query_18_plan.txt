DuckDB EXPLAIN ANALYZE - Query 18
================================================================================

┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE SELECT     c_name,     c_custkey,     o_orderkey,     o_orderdate,     o_totalprice,     sum(l_quantity) FROM     customer,     orders,     lineitem WHERE     o_orderkey IN (         SELECT             l_orderkey         FROM             lineitem         GROUP BY             l_orderkey         HAVING             sum(l_quantity) > 300)     AND c_custkey = o_custkey     AND o_orderkey = l_orderkey GROUP BY     c_name,     c_custkey,     o_orderkey,     o_orderdate,     o_totalprice ORDER BY     o_totalprice DESC,     o_orderdate LIMIT 100; 
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││         HTTPFS HTTP Stats         ││
││                                   ││
││            in: 10.6 GiB           ││
││            out: 0 bytes           ││
││              #HEAD: 3             ││
││            #GET: 15327            ││
││              #PUT: 0              ││
││              #POST: 0             ││
││             #DELETE: 0            ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 53.67s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│           TOP_N           │
│    ────────────────────   │
│          Top: 100         │
│                           │
│         Order By:         │
│     memory.main.orders    │
│     .o_totalprice DESC    │
│     memory.main.orders    │
│      .o_orderdate ASC     │
│                           │
│          100 rows         │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             #0            │
│__internal_decompress_integ│
│     ral_bigint(#1, 1)     │
│             #2            │
│             #3            │
│             #4            │
│             #5            │
│                           │
│        63,430 rows        │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│          Groups:          │
│             #0            │
│             #1            │
│             #2            │
│             #3            │
│             #4            │
│                           │
│    Aggregates: sum(#5)    │
│                           │
│        63,430 rows        │
│          (0.11s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│           c_name          │
│         c_custkey         │
│         o_orderkey        │
│        o_orderdate        │
│        o_totalprice       │
│         l_quantity        │
│                           │
│        444,010 rows       │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             #0            │
│             #1            │
│             #2            │
│             #3            │
│__internal_compress_integra│
│     l_uinteger(#4, 1)     │
│             #5            │
│                           │
│        444,010 rows       │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│             #0            │
│             #1            │
│             #2            │
│             #3            │
│__internal_decompress_integ│
│     ral_bigint(#4, 1)     │
│             #5            │
│                           │
│        444,010 rows       │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: INNER     │
│                           │
│        Conditions:        ├──────────────┐
│  l_orderkey = o_orderkey  │              │
│                           │              │
│        444,010 rows       │              │
│          (74.13s)         │              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││         PROJECTION        │
│    ────────────────────   ││    ────────────────────   │
│         Function:         ││             #0            │
│        READ_PARQUET       ││             #1            │
│                           ││             #2            │
│        Projections:       ││__internal_compress_integra│
│         l_orderkey        ││     l_uinteger(#3, 1)     │
│         l_quantity        ││             #4            │
│                           ││                           │
│    Total Files Read: 1    ││                           │
│                           ││                           │
│     5,999,665,955 rows    ││        63,430 rows        │
│          (93.73s)         ││          (0.00s)          │
└───────────────────────────┘└─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │
                             │    ────────────────────   │
                             │             #0            │
                             │             #1            │
                             │             #2            │
                             │__internal_decompress_integ│
                             │     ral_bigint(#3, 1)     │
                             │             #4            │
                             │                           │
                             │        63,430 rows        │
                             │          (0.00s)          │
                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │
                             │    ────────────────────   │
                             │      Join Type: INNER     │
                             │                           │
                             │        Conditions:        ├───────────────────────────────────────────┐
                             │   o_custkey = c_custkey   │                                           │
                             │                           │                                           │
                             │        63,430 rows        │                                           │
                             │          (44.97s)         │                                           │
                             └─────────────┬─────────────┘                                           │
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         PROJECTION        │
                             │    ────────────────────   │                             │    ────────────────────   │
                             │             #0            │                             │__internal_compress_integra│
                             │__internal_compress_integra│                             │     l_uinteger(#0, 1)     │
                             │     l_uinteger(#1, 1)     │                             │             #1            │
                             │             #2            │                             │                           │
                             │             #3            │                             │                           │
                             │                           │                             │                           │
                             │        63,430 rows        │                             │      149,999,999 rows     │
                             │          (0.00s)          │                             │          (0.38s)          │
                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         TABLE_SCAN        │
                             │    ────────────────────   │                             │    ────────────────────   │
                             │      Join Type: SEMI      │                             │         Function:         │
                             │                           │                             │        READ_PARQUET       │
                             │        Conditions:        │                             │                           │
                             │      o_orderkey = #0      │                             │        Projections:       │
                             │                           │                             │         c_custkey         │
                             │                           │                             │           c_name          │
                             │                           ├──────────────┐              │                           │
                             │                           │              │              │          Filters:         │
                             │                           │              │              │    c_custkey<=149999999   │
                             │                           │              │              │                           │
                             │                           │              │              │    Total Files Read: 1    │
                             │                           │              │              │                           │
                             │        63,430 rows        │              │              │      149,999,999 rows     │
                             │          (37.35s)         │              │              │          (16.39s)         │
                             └─────────────┬─────────────┘              │              └───────────────────────────┘
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         TABLE_SCAN        ││         PROJECTION        │
                             │    ────────────────────   ││    ────────────────────   │
                             │         Function:         ││             #0            │
                             │        READ_PARQUET       ││                           │
                             │                           ││                           │
                             │        Projections:       ││                           │
                             │         o_orderkey        ││                           │
                             │         o_custkey         ││                           │
                             │        o_totalprice       ││                           │
                             │        o_orderdate        ││                           │
                             │                           ││                           │
                             │    Total Files Read: 1    ││                           │
                             │                           ││                           │
                             │     1,499,919,137 rows    ││        63,430 rows        │
                             │         (1565.02s)        ││          (0.00s)          │
                             └───────────────────────────┘└─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐
                                                          │           FILTER          │
                                                          │    ────────────────────   │
                                                          │ (sum(l_quantity) > 300.00)│
                                                          │                           │
                                                          │        63,430 rows        │
                                                          │          (3.46s)          │
                                                          └─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐
                                                          │       HASH_GROUP_BY       │
                                                          │    ────────────────────   │
                                                          │         Groups: #0        │
                                                          │    Aggregates: sum(#1)    │
                                                          │                           │
                                                          │     1,500,000,000 rows    │
                                                          │         (766.14s)         │
                                                          └─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐
                                                          │         PROJECTION        │
                                                          │    ────────────────────   │
                                                          │         l_orderkey        │
                                                          │         l_quantity        │
                                                          │                           │
                                                          │     5,999,989,709 rows    │
                                                          │          (1.09s)          │
                                                          └─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐
                                                          │         TABLE_SCAN        │
                                                          │    ────────────────────   │
                                                          │         Function:         │
                                                          │        READ_PARQUET       │
                                                          │                           │
                                                          │        Projections:       │
                                                          │         l_orderkey        │
                                                          │         l_quantity        │
                                                          │                           │
                                                          │    Total Files Read: 1    │
                                                          │                           │
                                                          │     5,999,989,709 rows    │
                                                          │          (74.65s)         │
                                                          └───────────────────────────┘


================================================================================
