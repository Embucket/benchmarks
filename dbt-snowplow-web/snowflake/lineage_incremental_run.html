<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>dbt-snowplow-web Incremental Run - Snowflake</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 28px;
            font-weight: bold;
        }
        .diagram-container {
            background-color: #fafafa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #4CAF50;
            color: white;
            font-weight: 600;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .legend {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        .legend-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 10px;
        }
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: middle;
            border: 1px solid #333;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>dbt-snowplow-web Incremental Run - Snowflake</h1>
        <p>Generated: 2025-10-31 19:05:49</p>
        
        <h2>Summary Statistics</h2>
        <div class="summary">
            <div class="stat-card">
                <div class="stat-label">Total Models</div>
                <div class="stat-value">29</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Execution Time</div>
                <div class="stat-value">136.8s</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Average Time</div>
                <div class="stat-value">4.7s</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Slowest Model</div>
                <div class="stat-value">9.6s</div>
            </div>
        </div>
        
        <h2>Model Lineage</h2>
        <div class="legend">
            <strong>Schema Legend:</strong><br/>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #87CEEB;"></span>
                <span>Atomic (Source) - Raw events data</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #B19CD9;"></span>
                <span>Manifest (Metadata) - Tracking tables for incremental processing</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #FFB366;"></span>
                <span>Scratch (Intermediate) - Temporary transformations</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #90EE90;"></span>
                <span>Derived (Final Tables) - Final output tables</span>
            </div>
        </div>

        <div style="background-color: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin: 20px 0; border-radius: 4px;">
            <strong>Note:</strong> The diagram shows data flow from top to bottom. The <strong>events</strong> source table (blue) is the starting point for data transformations.
            Manifest tables (purple) like <em>incremental_manifest</em> and <em>base_quarantined_sessions</em> are metadata tracking tables used by the dbt-snowplow-web framework
            and may appear at the top due to having no data dependencies, but they support the incremental processing logic.
        </div>
        
        <div class="diagram-container">
            <div class="mermaid">
graph TD
    page_views["page_views<br/>7.3s"]
    pv_scroll_depth["pv_scroll_depth<br/>5.1s"]
    pv_engaged_time["pv_engaged_time<br/>5.0s"]
    page_views_this_run["page_views_this_run<br/>4.7s"]
    consent_scope_status["consent_scope_status<br/>2.3s"]
    consent_log["consent_log<br/>4.8s"]
    consent_cmp_stats["consent_cmp_stats<br/>3.0s"]
    consent_users["consent_users<br/>4.3s"]
    consent_versions["consent_versions<br/>4.1s"]
    consent_totals["consent_totals<br/>2.6s"]
    consent_events_this_run["consent_events_this_run<br/>4.8s"]
    vitals["vitals<br/>4.8s"]
    vital_measurements["vital_measurements<br/>4.3s"]
    vitals_this_run["vitals_this_run<br/>2.2s"]
    vital_events_this_run["vital_events_this_run<br/>2.7s"]
    user_mapping["user_mapping<br/>5.8s"]
    sessions["sessions<br/>9.6s"]
    sessions_this_run["sessions_this_run<br/>6.7s"]
    users["users<br/>6.7s"]
    users_sessions_this_run["users_sessions_this_run<br/>4.8s"]
    users_this_run["users_this_run<br/>3.0s"]
    users_aggs["users_aggs<br/>4.3s"]
    users_lasts["users_lasts<br/>3.8s"]
    incremental_manifest["incremental_manifest<br/>4.6s"]
    base_sessions_lifecycle_manifest["base_sessions_lifecycle_manifest<br/>7.7s"]
    base_quarantined_sessions["base_quarantined_sessions<br/>4.5s"]
    base_new_event_limits["base_new_event_limits<br/>3.2s"]
    base_sessions_this_run["base_sessions_this_run<br/>3.5s"]
    base_events_this_run["base_events_this_run<br/>6.5s"]
    events["events<br/>(source)"]
    page_views_this_run --> page_views
    base_new_event_limits --> page_views
    incremental_manifest --> page_views
    base_events_this_run --> pv_scroll_depth
    base_events_this_run --> pv_engaged_time
    base_events_this_run --> page_views_this_run
    pv_engaged_time --> page_views_this_run
    pv_scroll_depth --> page_views_this_run
    consent_users --> consent_scope_status
    consent_events_this_run --> consent_log
    base_new_event_limits --> consent_log
    incremental_manifest --> consent_log
    consent_log --> consent_cmp_stats
    consent_log --> consent_users
    consent_versions --> consent_users
    consent_log --> consent_versions
    consent_users --> consent_totals
    consent_versions --> consent_totals
    base_events_this_run --> consent_events_this_run
    base_new_event_limits --> consent_events_this_run
    incremental_manifest --> consent_events_this_run
    vitals_this_run --> vitals
    base_new_event_limits --> vitals
    incremental_manifest --> vitals
    vitals --> vital_measurements
    vital_events_this_run --> vitals_this_run
    base_new_event_limits --> vitals_this_run
    incremental_manifest --> vitals_this_run
    base_events_this_run --> vital_events_this_run
    base_new_event_limits --> vital_events_this_run
    incremental_manifest --> vital_events_this_run
    base_events_this_run --> user_mapping
    base_new_event_limits --> user_mapping
    incremental_manifest --> user_mapping
    sessions_this_run --> sessions
    base_new_event_limits --> sessions
    incremental_manifest --> sessions
    user_mapping --> sessions
    base_events_this_run --> sessions_this_run
    users_this_run --> users
    base_new_event_limits --> users
    incremental_manifest --> users
    sessions --> users_sessions_this_run
    base_sessions_this_run --> users_sessions_this_run
    users_aggs --> users_this_run
    users_sessions_this_run --> users_this_run
    users_lasts --> users_this_run
    users_sessions_this_run --> users_aggs
    users_sessions_this_run --> users_lasts
    users_aggs --> users_lasts
    base_new_event_limits --> base_sessions_lifecycle_manifest
    incremental_manifest --> base_sessions_lifecycle_manifest
    base_quarantined_sessions --> base_sessions_lifecycle_manifest
    events --> base_sessions_lifecycle_manifest
    incremental_manifest --> base_new_event_limits
    base_sessions_lifecycle_manifest --> base_sessions_this_run
    base_new_event_limits --> base_sessions_this_run
    base_quarantined_sessions --> base_sessions_this_run
    base_sessions_this_run --> base_events_this_run
    events --> base_events_this_run

    style page_views fill:#D3D3D3,stroke:#333,stroke-width:2px
    style pv_scroll_depth fill:#D3D3D3,stroke:#333,stroke-width:2px
    style pv_engaged_time fill:#D3D3D3,stroke:#333,stroke-width:2px
    style page_views_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_scope_status fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_log fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_cmp_stats fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_users fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_versions fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_totals fill:#D3D3D3,stroke:#333,stroke-width:2px
    style consent_events_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style vitals fill:#D3D3D3,stroke:#333,stroke-width:2px
    style vital_measurements fill:#D3D3D3,stroke:#333,stroke-width:2px
    style vitals_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style vital_events_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style user_mapping fill:#D3D3D3,stroke:#333,stroke-width:2px
    style sessions fill:#D3D3D3,stroke:#333,stroke-width:2px
    style sessions_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style users fill:#D3D3D3,stroke:#333,stroke-width:2px
    style users_sessions_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style users_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style users_aggs fill:#D3D3D3,stroke:#333,stroke-width:2px
    style users_lasts fill:#D3D3D3,stroke:#333,stroke-width:2px
    style incremental_manifest fill:#D3D3D3,stroke:#333,stroke-width:2px
    style base_sessions_lifecycle_manifest fill:#D3D3D3,stroke:#333,stroke-width:2px
    style base_quarantined_sessions fill:#D3D3D3,stroke:#333,stroke-width:2px
    style base_new_event_limits fill:#D3D3D3,stroke:#333,stroke-width:2px
    style base_sessions_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style base_events_this_run fill:#D3D3D3,stroke:#333,stroke-width:2px
    style events fill:#87CEEB,stroke:#333,stroke-width:2px
            </div>
        </div>
        
        <h2>Model Execution Details</h2>
        <table>
            <thead>
                <tr>
                    <th>Model Name</th>
                    <th>Schema</th>
                    <th>Execution Time</th>
                    <th>Rows Affected</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                
        <tr>
            <td>snowplow_web_sessions</td>
            <td>snowplow_manifest_derived</td>
            <td>9.63s</td>
            <td>2,996</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_base_sessions_lifecycle_manifest</td>
            <td>snowplow_manifest_snowplow_manifest</td>
            <td>7.72s</td>
            <td>2,996</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_page_views</td>
            <td>snowplow_manifest_derived</td>
            <td>7.27s</td>
            <td>2,996</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_users</td>
            <td>snowplow_manifest_derived</td>
            <td>6.73s</td>
            <td>2,996</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_sessions_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>6.71s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_base_events_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>6.51s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_user_mapping</td>
            <td>snowplow_manifest_derived</td>
            <td>5.76s</td>
            <td>2,996</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_pv_scroll_depth</td>
            <td>snowplow_manifest_scratch</td>
            <td>5.10s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_pv_engaged_time</td>
            <td>snowplow_manifest_scratch</td>
            <td>5.02s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_events_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>4.82s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_log</td>
            <td>snowplow_manifest_derived</td>
            <td>4.82s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_users_sessions_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>4.80s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_vitals</td>
            <td>snowplow_manifest_derived</td>
            <td>4.80s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_page_views_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>4.73s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_incremental_manifest</td>
            <td>snowplow_manifest_snowplow_manifest</td>
            <td>4.56s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_base_quarantined_sessions</td>
            <td>snowplow_manifest_snowplow_manifest</td>
            <td>4.53s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_vital_measurements</td>
            <td>snowplow_manifest_derived</td>
            <td>4.29s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_users</td>
            <td>snowplow_manifest_derived</td>
            <td>4.28s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_users_aggs</td>
            <td>snowplow_manifest_scratch</td>
            <td>4.25s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_versions</td>
            <td>snowplow_manifest_derived</td>
            <td>4.06s</td>
            <td>0</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_users_lasts</td>
            <td>snowplow_manifest_scratch</td>
            <td>3.79s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_base_sessions_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>3.54s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_base_new_event_limits</td>
            <td>snowplow_manifest_scratch</td>
            <td>3.22s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_cmp_stats</td>
            <td>snowplow_manifest_derived</td>
            <td>3.05s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_users_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>3.04s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_vital_events_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>2.74s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_totals</td>
            <td>snowplow_manifest_derived</td>
            <td>2.59s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_consent_scope_status</td>
            <td>snowplow_manifest_derived</td>
            <td>2.29s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
        <tr>
            <td>snowplow_web_vitals_this_run</td>
            <td>snowplow_manifest_scratch</td>
            <td>2.18s</td>
            <td>1</td>
            <td>success</td>
        </tr>
        
            </tbody>
        </table>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>